{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://unpkg.com/@camaradesuk/git-worktree-tools@latest/schemas/worktreerc.schema.json",
  "title": "Git Worktree Tools Configuration",
  "description": "Configuration schema for .worktreerc, .worktreerc.local, and global config files used by git-worktree-tools. Config priority: local > repo > global > defaults.",
  "type": "object",
  "additionalProperties": false,
  "properties": {
    "$schema": {
      "type": "string",
      "description": "JSON Schema reference for editor support. Recommended: https://unpkg.com/@camaradesuk/git-worktree-tools@latest/schemas/worktreerc.schema.json"
    },
    "configVersion": {
      "type": "integer",
      "minimum": 1,
      "description": "Configuration schema version for migration support. Current version: 1. Only increment for breaking schema changes."
    },
    "sharedRepos": {
      "type": "array",
      "items": { "type": "string" },
      "description": "Sibling repos to also create worktrees for (e.g., ['cluster-gitops', 'infrastructure'])"
    },
    "baseBranch": {
      "type": "string",
      "default": "main",
      "description": "Base branch for new PRs"
    },
    "draftPr": {
      "type": "boolean",
      "default": false,
      "description": "Create PRs as drafts by default"
    },
    "worktreePattern": {
      "type": "string",
      "default": "{repo}.pr{number}",
      "description": "Worktree directory naming pattern. Placeholders: {repo}, {number}, {branch}"
    },
    "worktreeParent": {
      "type": "string",
      "default": "..",
      "description": "Parent directory for worktrees (absolute or relative to repo root)"
    },
    "syncPatterns": {
      "type": "array",
      "items": { "type": "string" },
      "description": "Gitignored config files to sync between worktrees via hard links (e.g., ['.env.local', '.vscode/settings.json'])"
    },
    "branchPrefix": {
      "type": "string",
      "default": "feat",
      "description": "Branch name prefix for auto-generated branches"
    },
    "previewLabel": {
      "type": "string",
      "default": "preview",
      "description": "Label name to highlight in PR list"
    },
    "preferredEditor": {
      "type": "string",
      "enum": ["vscode", "cursor", "auto"],
      "default": "vscode",
      "description": "Preferred editor for 'Open in editor' action in lswt interactive mode"
    },
    "ai": {
      "$ref": "#/definitions/AIConfig"
    },
    "hooks": {
      "$ref": "#/definitions/HooksConfig"
    },
    "hookDefaults": {
      "$ref": "#/definitions/HookDefaultsConfig"
    },
    "plugins": {
      "type": "array",
      "items": { "type": "string" },
      "description": "Plugin packages to load (npm packages or paths to local plugin files)"
    },
    "generators": {
      "$ref": "#/definitions/GeneratorsConfig"
    },
    "integrations": {
      "$ref": "#/definitions/IntegrationsConfig"
    },
    "logging": {
      "$ref": "#/definitions/LoggingConfig"
    },
    "global": {
      "$ref": "#/definitions/GlobalSettings"
    },
    "wtlink": {
      "$ref": "#/definitions/WtlinkConfig"
    }
  },
  "definitions": {
    "AIConfig": {
      "type": "object",
      "additionalProperties": false,
      "description": "AI content generation configuration",
      "properties": {
        "provider": {
          "type": "string",
          "enum": ["auto", "claude", "gemini", "openai", "ollama", "script", "fallback", "none"],
          "default": "none",
          "description": "AI provider to use"
        },
        "fallback": {
          "type": "string",
          "enum": ["auto", "claude", "gemini", "openai", "ollama", "script", "fallback", "none"],
          "description": "Fallback provider if primary fails"
        },
        "branchName": {
          "type": "boolean",
          "default": false,
          "description": "Enable AI for branch names"
        },
        "prTitle": {
          "type": "boolean",
          "default": false,
          "description": "Enable AI for PR titles"
        },
        "prDescription": {
          "type": "boolean",
          "default": false,
          "description": "Enable AI for PR descriptions"
        },
        "commitMessage": {
          "type": "boolean",
          "default": false,
          "description": "Enable AI for commit messages"
        },
        "planDocument": {
          "type": "boolean",
          "default": false,
          "description": "Enable AI for plan documents"
        },
        "branchStyle": {
          "type": "string",
          "enum": ["conventional", "kebab", "snake"],
          "default": "kebab",
          "description": "Branch naming style"
        },
        "commitStyle": {
          "type": "string",
          "enum": ["conventional", "gitmoji", "simple"],
          "default": "conventional",
          "description": "Commit message style"
        },
        "prTemplate": {
          "type": "string",
          "description": "Path to PR description template"
        },
        "planTemplate": {
          "type": "string",
          "description": "Path to plan document template"
        },
        "claude": {
          "type": "object",
          "additionalProperties": false,
          "properties": {
            "model": {
              "type": "string",
              "description": "Claude model to use"
            }
          }
        },
        "gemini": {
          "type": "object",
          "additionalProperties": false,
          "properties": {
            "model": {
              "type": "string",
              "description": "Gemini model to use"
            }
          }
        },
        "openai": {
          "type": "object",
          "additionalProperties": false,
          "properties": {
            "model": {
              "type": "string",
              "description": "OpenAI model to use"
            }
          }
        },
        "ollama": {
          "type": "object",
          "additionalProperties": false,
          "properties": {
            "model": {
              "type": "string",
              "description": "Ollama model to use"
            },
            "host": {
              "type": "string",
              "description": "Ollama host URL"
            }
          }
        },
        "script": {
          "type": "object",
          "additionalProperties": false,
          "required": ["path"],
          "properties": {
            "path": {
              "type": "string",
              "description": "Path to custom script provider"
            }
          }
        }
      }
    },
    "HooksConfig": {
      "type": "object",
      "additionalProperties": false,
      "description": "Lifecycle hooks configuration",
      "properties": {
        "pre-analyze": { "$ref": "#/definitions/HookDefinition" },
        "post-analyze": { "$ref": "#/definitions/HookDefinition" },
        "pre-branch": { "$ref": "#/definitions/HookDefinition" },
        "post-branch": { "$ref": "#/definitions/HookDefinition" },
        "pre-commit": { "$ref": "#/definitions/HookDefinition" },
        "post-commit": { "$ref": "#/definitions/HookDefinition" },
        "pre-push": { "$ref": "#/definitions/HookDefinition" },
        "post-push": { "$ref": "#/definitions/HookDefinition" },
        "pre-pr": { "$ref": "#/definitions/HookDefinition" },
        "post-pr": { "$ref": "#/definitions/HookDefinition" },
        "pre-worktree": { "$ref": "#/definitions/HookDefinition" },
        "post-worktree": { "$ref": "#/definitions/HookDefinition" },
        "cleanup": { "$ref": "#/definitions/HookDefinition" }
      }
    },
    "HookDefinition": {
      "description": "Hook definition - can be a simple command string, array of commands, or complex object",
      "oneOf": [
        {
          "type": "string",
          "description": "Simple shell command to run"
        },
        {
          "type": "array",
          "items": { "type": "string" },
          "description": "Multiple shell commands to run"
        },
        {
          "type": "object",
          "additionalProperties": false,
          "description": "Complex hook definition with options",
          "properties": {
            "command": {
              "type": "string",
              "description": "Shell command to run"
            },
            "script": {
              "type": "string",
              "description": "Path to script file"
            },
            "timeout": {
              "type": "number",
              "minimum": 0,
              "description": "Timeout in milliseconds (default: 30000)"
            },
            "failOnError": {
              "type": "boolean",
              "default": true,
              "description": "Whether to fail on error"
            },
            "if": {
              "type": "string",
              "description": "Condition for running the hook"
            },
            "env": {
              "type": "object",
              "additionalProperties": { "type": "string" },
              "description": "Additional environment variables"
            }
          }
        }
      ]
    },
    "HookDefaultsConfig": {
      "type": "object",
      "additionalProperties": false,
      "description": "Default settings for hook execution",
      "properties": {
        "timeout": {
          "type": "number",
          "minimum": 0,
          "default": 30000,
          "description": "Default timeout for individual hook execution (in milliseconds)"
        },
        "maxTimeout": {
          "type": "number",
          "minimum": 0,
          "default": 60000,
          "description": "Maximum timeout allowed for any hook (in milliseconds)"
        }
      }
    },
    "GeneratorsConfig": {
      "type": "object",
      "additionalProperties": false,
      "description": "Custom generator scripts configuration",
      "properties": {
        "branchName": {
          "type": "string",
          "description": "Path to custom branch name generator script"
        },
        "prTitle": {
          "type": "string",
          "description": "Path to custom PR title generator script"
        },
        "prDescription": {
          "type": "string",
          "description": "Path to custom PR description generator script"
        },
        "commitMessage": {
          "type": "string",
          "description": "Path to custom commit message generator script"
        }
      }
    },
    "IntegrationsConfig": {
      "type": "object",
      "additionalProperties": false,
      "description": "Third-party integrations configuration",
      "properties": {
        "linear": {
          "$ref": "#/definitions/LinearIntegration"
        },
        "jira": {
          "$ref": "#/definitions/JiraIntegration"
        },
        "slack": {
          "$ref": "#/definitions/SlackIntegration"
        }
      }
    },
    "LinearIntegration": {
      "type": "object",
      "additionalProperties": false,
      "description": "Linear integration configuration",
      "properties": {
        "teamId": {
          "type": "string",
          "description": "Linear team ID for issue linking"
        },
        "apiKeyEnv": {
          "type": "string",
          "default": "LINEAR_API_KEY",
          "description": "API key environment variable name"
        }
      }
    },
    "JiraIntegration": {
      "type": "object",
      "additionalProperties": false,
      "description": "Jira integration configuration",
      "properties": {
        "projectKey": {
          "type": "string",
          "description": "Jira project key (e.g., 'PROJ')"
        },
        "baseUrl": {
          "type": "string",
          "description": "Jira base URL"
        },
        "apiTokenEnv": {
          "type": "string",
          "default": "JIRA_API_TOKEN",
          "description": "API token environment variable name"
        }
      }
    },
    "SlackIntegration": {
      "type": "object",
      "additionalProperties": false,
      "description": "Slack integration configuration",
      "properties": {
        "webhookUrl": {
          "type": "string",
          "description": "Slack webhook URL for notifications (or environment variable name)"
        },
        "channel": {
          "type": "string",
          "description": "Default channel for notifications"
        }
      }
    },
    "LoggingConfig": {
      "type": "object",
      "additionalProperties": false,
      "description": "Logging configuration for controlling verbosity and output",
      "properties": {
        "level": {
          "type": "string",
          "enum": ["silent", "error", "warn", "info", "debug", "trace"],
          "default": "info",
          "description": "Log level threshold. Options: silent (no output), error, warn, info (default), debug, trace (most verbose)"
        },
        "logFile": {
          "type": "string",
          "description": "Path to log file for persistent logging. Logs are written in JSON Lines format. Supports ~ for home directory."
        },
        "timestamps": {
          "type": "boolean",
          "default": true,
          "description": "Include timestamps in log output"
        }
      }
    },
    "GlobalSettings": {
      "type": "object",
      "additionalProperties": false,
      "description": "Global settings that typically live in the global config file (~/.config/git-worktree-tools/config.json)",
      "properties": {
        "warnNotGlobal": {
          "type": "boolean",
          "default": false,
          "description": "Show a warning if the package is not installed globally"
        },
        "logging": {
          "$ref": "#/definitions/LoggingConfig",
          "description": "Default logging configuration (can be overridden by repo/local configs)"
        }
      }
    },
    "WtlinkConfig": {
      "type": "object",
      "additionalProperties": false,
      "description": "Configuration for wtlink - worktree config file linking. Use this for full manifest control with enable/disable state tracking. For simpler use cases, see syncPatterns.",
      "properties": {
        "enabled": {
          "type": "array",
          "items": { "type": "string" },
          "description": "Git-ignored files to actively link between worktrees. These files will be hard-linked from the main worktree to feature worktrees. (e.g., ['.vscode/settings.json', '.env.local', 'node_modules'])"
        },
        "disabled": {
          "type": "array",
          "items": { "type": "string" },
          "description": "Git-ignored files tracked in manifest but not currently linked. These can be re-enabled via 'wtlink manage'. Useful for temporarily disabling files without losing track of them."
        }
      }
    }
  }
}
